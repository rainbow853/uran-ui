var d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function f(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}function m(h){if(h.__esModule)return h;var e=h.default;if(typeof e=="function"){var i=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(h).forEach(function(t){var n=Object.getOwnPropertyDescriptor(h,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return h[t]}})}),i}class l{constructor(e,i){const{inw:t,inh:n,outw:o,outh:s,minWH:a,maxWH:r,limitInWindow:c,limitSize:u}=e;this.inw=t,this.inh=n,this.outw=o,this.outh=s,this.minWH=a||1,this.maxWH=r||1/0,this.minScale=this.maxScale=1,this.limitInWindow=c||!1,this.limitSize=u??100,i||this.resize()}translate(e,i){this.updateMatrix(this.scale,this.dx+e,this.dy+i)}zoom(e,i,t){const{dx:n,dy:o,scale:s,minScale:a,maxScale:r}=this;s*t>r?t=r/s:s*t<a&&(t=a/s),this.updateMatrix(s*t,(n-e)*t+e,(o-i)*t+i)}zoomToByInCoor(e,i,t){const{outw:n,outh:o,minScale:s,maxScale:a}=this;t=Math.min(a,Math.max(s,t)),this.updateMatrix(t,n/2-e*t,o/2-i*t)}resize(){const{outw:e,outh:i,inw:t,inh:n,minWH:o,maxWH:s}=this;let a;e/i>t/n?a=i/n:a=e/t,this.minScale=Math.min(a,o/t,o/n),this.maxScale=Math.max(a,s/t,s/n),this.updateMatrix(a,(e-t*a)/2,(i-n*a)/2)}scrollToRect(e,i,t,n,o){o=o??100;const{outw:s,outh:a}=this,r=Math.min(s/(t+o),a/(n+o));this.zoomToByInCoor(e+t/2,i+n/2,r)}updateMatrix(e,i,t){if(this.limitInWindow){const{inw:n,inh:o,outw:s,outh:a,limitSize:r}=this;i=Math.min(s-r,Math.max(-n*e+r,i)),t=Math.min(a-r,Math.max(-o*e+r,t))}this.scale=e,this.dx=i,this.dy=t,this.updateInvMatrix()}updateInvMatrix(){this.invScale=1/this.scale,this.invDx=-this.dx/this.scale,this.invDy=-this.dy/this.scale}inCoorIsIn(e,i){const{inw:t,inh:n}=this;return e>=0&&e<t&&i>=0&&i<n}outCoorIsIn(e,i){const{outw:t,outh:n}=this;return e>=0&&e<t&&i>=0&&i<n}transCoors(e,i,t,n){const o=[];for(let s=1;s<e.length;s=s+2)o.push(~~(e[s-1]*i+t),~~(e[s]*i+n));return o}transInToOut(e){const{scale:i,dx:t,dy:n}=this;return this.transCoors(e,i,t,n)}transOutToIn(e){const{invScale:i,invDx:t,invDy:n}=this;return this.transCoors(e,i,t,n)}}const p=Object.freeze(Object.defineProperty({__proto__:null,TransferToWindow:l,default:l},Symbol.toStringTag,{value:"Module"}));export{l as T,f as a,d as c,p as d,m as g};
